{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from \"react\";\nimport { Translate } from \"react-localize-redux\";\nimport { CreateShopContext } from \"../CreateShopContext\";\nimport SelectAddress from \"./../../UserPanel/PanelPages/Addresses/AddressesLayouts/SelectAddress\";\nimport { BoxStyle3 } from \"./../../../../common\";\nimport { CSSTransition } from \"react-transition-group\";\nimport { COMPLETE_AND_NEXT } from \"../CreateShopConstant\";\nimport { FormErrorMsg } from \"../../../../common\";\nimport Select from \"react-select\";\nimport { client_getParentCategory } from \"./../../../../../lib/api/client/clientShop\";\nimport Geocode from \"react-geocode\";\nimport { validateEmpty, validatePhoneNumber } from \"../../../../../lib/formValidator\";\n\nvar Store = /*#__PURE__*/function (_React$Component) {\n  _inherits(Store, _React$Component);\n\n  var _super = _createSuper(Store);\n\n  function Store(props) {\n    var _this;\n\n    _classCallCheck(this, Store);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"setErrors\", function (func) {\n      var error = func(_this.state.errors);\n\n      _this.setState({\n        errors: error\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setData\", function (data) {\n      var newData = _objectSpread({}, _this.state.data);\n\n      for (var key in data) {\n        newData[key] = data[key];\n      }\n\n      _this.setState({\n        fullAddress: newData.address,\n        lat: newData.Location.lat,\n        lang: newData.Location.lng,\n        dontSetLocation: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePersonChange\", function (event) {\n      _this.setState(_objectSpread(_objectSpread({}, _this.state), {}, {\n        personId: event.value\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleNameChange\", function (event) {\n      _this.setState({\n        name: event.target.value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleShopNameChange\", function (event) {\n      _this.setState({\n        shopName: event.target.value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleAddressChange\", function (event) {\n      _this.setState({\n        fullAddress: event.target.value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePhoneChange\", function (event) {\n      _this.setState({\n        phone: event.target.value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSubmit\", function (e) {\n      e.preventDefault();\n      debugger;\n\n      if (_this.state.selectedCategory == null) {\n        _this.setState({\n          categoryEmptyError: true\n        });\n\n        return;\n      }\n\n      for (var key in _this.state.errors) {\n        if (_this.state.errors[key]) {\n          return;\n        }\n      }\n\n      _this.context.handleStore(_this.state.personId, _this.state.name, _this.state.shopName, _this.state.fullAddress, _this.state.selectedCategory, _this.state.phone, _this.state.lat, _this.state.lang);\n\n      _this.context.handleStep(COMPLETE_AND_NEXT);\n\n      _this.setState({\n        categoryEmptyError: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCategoryChange\", function (item) {\n      _this.setState(_objectSpread(_objectSpread({}, _this.state), {}, {\n        selectedCategory: item\n      }));\n    });\n\n    _this.state = {\n      showSelectAddress: false,\n      data: {},\n      personId: 1,\n      errors: {},\n      name: \"\",\n      shopName: \"\",\n      fullAddress: \"\",\n      phone: \"\",\n      lat: 0,\n      lang: 0,\n      dontSetLocation: true,\n      selectedCategory: null,\n      categoryOptions: [],\n      categoryEmptyError: false,\n      cityName: \"\",\n      countryName: \"\",\n      phoneCode: \"\",\n      iso: \"\",\n      optopns: [{\n        value: 1,\n        label: \"Legal\"\n      }, {\n        value: 2,\n        label: \"Natural\"\n      }]\n    };\n    _this.API_KEY = process.env.NEXT_PUBLIC_GOOGLE_MAP_API_KEY;\n    _this.handleSituation = _this.handleSituation.bind(_assertThisInitialized(_this));\n    _this.handlePersonChange = _this.handlePersonChange.bind(_assertThisInitialized(_this));\n    _this.handleAddressChange = _this.handleAddressChange.bind(_assertThisInitialized(_this));\n    _this.handleShopNameChange = _this.handleShopNameChange.bind(_assertThisInitialized(_this));\n    _this.handleNameChange = _this.handleNameChange.bind(_assertThisInitialized(_this));\n    _this.handleCategoryChange = _this.handleCategoryChange.bind(_assertThisInitialized(_this));\n    _this.handlePhoneChange = _this.handlePhoneChange.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Store, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        var result, items;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return client_getParentCategory();\n\n              case 2:\n                result = _context.sent;\n                items = [];\n                result.result.forEach(function (item) {\n                  items.push({\n                    value: item.categoryId,\n                    label: item.categoryTitle\n                  });\n                });\n                this.state.categoryOptions = items; // let phoneNumber = \"\";\n                // if (this.context.formData.phone === \"\") {\n                //   phoneNumber = \"+\" + this.context.formData.phoneCode;\n                // } else {\n                //   phoneNumber = this.context.formData.phone;\n                // }\n\n                this.setState({\n                  personId: this.context.formData.fkPersonId == 2 ? 2 : 1,\n                  name: this.context.formData.fkPersonId == 2 ? this.context.formData.fullName : this.context.formData.companyName,\n                  shopName: this.context.formData.storeName,\n                  fullAddress: this.context.formData.address,\n                  selectedCategory: this.context.filesData.selectedCategory,\n                  phone: this.context.formData.phone,\n                  cityName: this.context.formData.cityName,\n                  countryName: this.context.formData.countryName,\n                  iso: this.context.formData.iso,\n                  lat: this.context.formData.locationX,\n                  lang: this.context.formData.locationY\n                });\n                Geocode.setApiKey(this.API_KEY);\n\n                if (this.state.lat == 0 && this.state.lang == 0) {\n                  Geocode.fromAddress(this.state.cityName, null, this.props.lang).then(function (response) {\n                    var address = response.results[0].geometry;\n\n                    _this2.setState({\n                      lat: address.location.lat,\n                      lang: address.location.lng\n                    });\n                  }, function (error) {});\n                } else {\n                  this.setState({\n                    dontSetLocation: false\n                  });\n                }\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"handleSituation\",\n    value: function handleSituation(_ref) {\n      var type = _ref.type;\n\n      switch (type) {\n        case \"showMap\":\n          this.setState({\n            showSelectAddress: true\n          });\n          break;\n\n        case \"hideMap\":\n          this.setState({\n            showSelectAddress: false\n          });\n          break;\n\n        default:\n          break;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return __jsx(\"form\", {\n        className: \"createshop__transition-cnt\",\n        onSubmit: this.handleSubmit\n      }, __jsx(\"div\", {\n        className: \"mt-5\"\n      }, __jsx(\"h3\", {\n        className: \"createshop__header-text\"\n      }, __jsx(Translate, {\n        id: \"store.store-msg1\"\n      })), __jsx(\"div\", {\n        className: \"createshop__form createshop__form--store\"\n      }, __jsx(Translate, null, function (_ref2) {\n        var t = _ref2.translate;\n\n        if (_this3.state.showSelectAddress) {\n          return __jsx(CSSTransition, {\n            appear: true,\n            \"in\": true,\n            classNames: \"user-panel__routes\",\n            timeout: 400\n          }, __jsx(BoxStyle3, null, __jsx(SelectAddress, {\n            setData: _this3.setData,\n            handleSituation: _this3.handleSituation,\n            lat: _this3.state.lat,\n            lng: _this3.state.lang,\n            dontSetLocation: _this3.state.dontSetLocation,\n            selectedCountry: _this3.state.countryName\n          })));\n        } else {\n          return __jsx(React.Fragment, null, __jsx(\"div\", {\n            className: \"createshop__form-cnt row justify-content-between\"\n          }, __jsx(\"div\", {\n            className: \"col-12 col-sm-6\"\n          }, __jsx(\"label\", {\n            className: \"auth__form-label\"\n          }, __jsx(\"span\", {\n            className: \"auth__input-label\"\n          }, __jsx(Translate, {\n            id: \"store.person\"\n          })), __jsx(Select, {\n            className: \"react-select\",\n            options: _this3.state.optopns,\n            onChange: _this3.handlePersonChange,\n            placeholder: t(\"store.person-placeholder\"),\n            value: _this3.state.personId == 1 ? _this3.state.optopns[0] : _this3.state.optopns[1],\n            required: true\n          }))), __jsx(\"div\", {\n            className: \"col-12 col-sm-6\"\n          }, __jsx(\"label\", {\n            className: \"auth__form-label\"\n          }, __jsx(\"span\", {\n            className: \"auth__input-label\"\n          }, _this3.state.personId != 2 && __jsx(Translate, {\n            id: \"store.company-name\"\n          }), _this3.state.personId == 2 && __jsx(Translate, {\n            id: \"store.fullname\"\n          })), __jsx(\"input\", {\n            className: \"gray__input\",\n            type: \"string\",\n            placeholder: _this3.state.personId == 2 ? t(\"store.full-name-placeholder\") : t(\"store.company-name-placeholder\"),\n            onBlur: function onBlur(e) {\n              validateEmpty({\n                name: \"name\",\n                value: e.target.value,\n                handler: _this3.setErrors,\n                lang: _this3.context.lang\n              });\n            },\n            required: true,\n            onChange: _this3.handleNameChange,\n            value: _this3.state.name\n          }), __jsx(FormErrorMsg, {\n            show: _this3.state.errors[\"name\"],\n            msg: _this3.state.errors[\"name\"]\n          }))), __jsx(\"div\", {\n            className: \"col-12 col-sm-6\"\n          }, __jsx(\"label\", {\n            className: \"auth__form-label\"\n          }, __jsx(\"span\", {\n            className: \"auth__input-label\"\n          }, __jsx(Translate, {\n            id: \"store.store-name\"\n          })), __jsx(\"input\", {\n            className: \"gray__input\",\n            type: \"string\",\n            placeholder: t(\"store.store-name-placeholder\"),\n            onBlur: function onBlur(e) {\n              validateEmpty({\n                name: \"Companyname\",\n                value: e.target.value,\n                handler: _this3.setErrors,\n                lang: _this3.context.lang\n              });\n            },\n            required: true,\n            onChange: _this3.handleShopNameChange,\n            value: _this3.state.shopName\n          }), __jsx(FormErrorMsg, {\n            show: _this3.state.errors[\"Companyname\"],\n            msg: _this3.state.errors[\"Companyname\"]\n          }))), __jsx(\"div\", {\n            className: \"col-12\"\n          }, __jsx(\"label\", {\n            className: \"auth__form-label\"\n          }, __jsx(\"span\", {\n            className: \"auth__input-label\"\n          }, __jsx(Translate, {\n            id: \"store.kind-pro\"\n          })), __jsx(Select, {\n            className: \"react-select\",\n            options: _this3.state.categoryOptions,\n            onChange: _this3.handleCategoryChange,\n            placeholder: t(\"store.kind-pro-placeholder\"),\n            value: _this3.state.selectedCategory,\n            required: true\n          })), _this3.state.categoryEmptyError && __jsx(\"span\", {\n            className: \"country-error\"\n          }, __jsx(Translate, {\n            id: \"store.select-category-error\"\n          }))), __jsx(\"div\", {\n            className: \"col-12\"\n          }, __jsx(\"label\", {\n            className: \"auth__form-label\"\n          }, __jsx(\"span\", {\n            className: \"select-address-wrapper\",\n            onClick: function onClick() {\n              return _this3.handleSituation({\n                type: \"showMap\"\n              });\n            }\n          }, __jsx(Translate, {\n            id: \"addresses.select-map\"\n          }), __jsx(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            id: \"placeholder\",\n            width: \"21.225\",\n            height: \"33.106\",\n            viewBox: \"0 0 21.225 33.106\"\n          }, __jsx(\"path\", {\n            id: \"Subtraction_7\",\n            fill: \"#acb1b8\",\n            d: \"M10.613 33.106L6.25 20.286a10.612 10.612 0 1 1 8.727 0L10.614 33.1zm0-30a7.5 7.5 0 1 0 7.5 7.5 7.513 7.513 0 0 0-7.5-7.497z\",\n            \"data-name\": \"Subtraction 7\"\n          }))))), __jsx(\"div\", {\n            className: \"col-12\"\n          }, __jsx(\"label\", {\n            className: \"auth__form-label\"\n          }, __jsx(\"span\", {\n            className: \"auth__input-label\"\n          }, __jsx(Translate, {\n            id: \"store.address\"\n          })), __jsx(\"textarea\", {\n            placeholder: t(\"store.address-placeholder\"),\n            className: \"gray__input\",\n            rows: \"5\",\n            value: _this3.state.fullAddress,\n            onChange: _this3.handleAddressChange\n          }), __jsx(FormErrorMsg, {\n            show: _this3.state.errors[\"Address\"],\n            msg: _this3.state.errors[\"Address\"]\n          })))));\n        }\n      }))), __jsx(\"div\", {\n        className: \"createshop__btm text-align-center-ltr mb-5\"\n      }, !this.state.showSelectAddress ? __jsx(\"div\", {\n        className: \"auth__btn\"\n      }, __jsx(\"button\", {\n        type: \"submit\",\n        className: \"createshop__primary-btn primary-btn\"\n      }, __jsx(Translate, {\n        id: \"country.next\"\n      }))) : null));\n    }\n  }]);\n\n  return Store;\n}(React.Component);\n\n_defineProperty(Store, \"contextType\", CreateShopContext);\n\nexport default Store;","map":null,"metadata":{},"sourceType":"module"}