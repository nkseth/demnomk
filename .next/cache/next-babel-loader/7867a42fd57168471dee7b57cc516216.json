{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from \"react\";\nimport { Translate } from \"react-localize-redux\";\nimport { UploadBox, Loading } from \"../../../../common\";\nimport { END, COMPLETE_AND_NEXT } from \"../CreateShopConstant\";\nimport { CreateShopContext } from \"../CreateShopContext\";\nimport { FormErrorMsg } from \"../../../../common\";\nimport { client_getShopActiveDocumentById } from \"./../../../../../lib/api/client/clientShop\";\nimport { TAXGRPOUPID } from \"./../CreateShopConstant\";\n\nclass Vat extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"handleVatChange\", event => {\n      this.setState({\n        vat: event.target.value\n      });\n    });\n\n    _defineProperty(this, \"changeAccept\", () => {\n      this.setState({\n        isAccepted: !this.state.isAccepted\n      });\n    });\n\n    _defineProperty(this, \"handleSelectFile\", (file, index) => {\n      this.state.files[index] = file[0];\n      this.state.filesModel[index].FileUrl = \"file.jpg\";\n    });\n\n    _defineProperty(this, \"handleSubmit\", async event => {\n      event.preventDefault();\n\n      for (let key in this.state.errors) {\n        if (this.state.errors[key]) {\n          return;\n        }\n      }\n\n      let valid = true; // this.state.files.forEach((element) => {\n      //   if (element == null) {\n      //     this.setState({ showUploadFileError: true });\n      //     valid = false;\n      //   }\n      // });\n\n      if (valid) {\n        this.context.handleVat(this.state.vat, this.state.filesModel, this.state.files);\n        this.setState({\n          showSubmitLoader: true\n        });\n        let isFinish = await this.context.finalSubmit();\n\n        if (isFinish) {\n          this.context.handleStep(COMPLETE_AND_NEXT);\n          this.setState({\n            showSubmitLoader: false\n          });\n        } else {\n          this.setState({\n            showSubmitLoader: false\n          });\n        }\n      }\n    });\n\n    _defineProperty(this, \"setErrors\", func => {\n      const error = func(this.state.errors);\n      this.setState({\n        errors: error\n      });\n    });\n\n    _defineProperty(this, \"handleVatFromParent\", () => {\n      this.context.handleVat(this.state.vat, this.state.filesModel, this.state.files);\n    });\n\n    this.state = {\n      vat: \"\",\n      documents: [],\n      filesModel: [],\n      files: [],\n      errors: {},\n      isAccepted: false,\n      showUploadFileError: false,\n      showComponent: false,\n      showLoader: false,\n      showSubmitLoader: false\n    };\n    this.handleSelectFile = this.handleSelectFile.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.changeAccept = this.changeAccept.bind(this);\n  }\n\n  async componentDidMount() {\n    this.setState({\n      showLoader: true\n    });\n    const result = await client_getShopActiveDocumentById(TAXGRPOUPID);\n    this.setState({\n      documents: result.result\n    });\n\n    if (this.context.filesData.taxFiles.length > 0) {\n      this.setState({\n        vat: this.context.formData.taxRegistrationNumber,\n        filesModel: this.context.filesData.taxFileDto,\n        files: this.context.filesData.taxFiles\n      }, () => {\n        this.setState({\n          showComponent: true\n        });\n      });\n    } else {\n      result.result.forEach((item, index) => {\n        this.state.filesModel.push({\n          fileId: 0,\n          shopId: 0,\n          FkDocumentTypeId: this.state.documents[index].documentTypeId,\n          FileUrl: \"\",\n          index: index\n        });\n        this.state.files.push(null);\n      });\n      this.setState({\n        showComponent: true\n      });\n    }\n\n    this.setState({\n      showLoader: false\n    });\n  }\n\n  render() {\n    return __jsx(\"form\", {\n      className: \"createshop__transition-cnt\",\n      onSubmit: this.handleSubmit\n    }, this.state.showLoader ? __jsx(Loading, {\n      type: \"gray\",\n      width: \"11%\",\n      height: \"70%\"\n    }) : __jsx(\"div\", null, __jsx(\"div\", {\n      className: \"mt-5\"\n    }, __jsx(\"h3\", {\n      className: \"createshop__header-text\"\n    }, __jsx(Translate, {\n      id: \"vat.vat-msg1\"\n    })), __jsx(\"div\", {\n      className: \"createshop__form createshop__form--vat\"\n    }, __jsx(Translate, null, ({\n      translate: t\n    }) => {\n      return __jsx(React.Fragment, null, __jsx(\"label\", {\n        className: \"auth__form-label\"\n      }, __jsx(\"span\", {\n        className: \"auth__input-label\"\n      }, __jsx(Translate, {\n        id: \"vat.tax-input-label\"\n      })), __jsx(\"input\", {\n        className: \"gray__input\",\n        type: \"text\",\n        placeholder: t(\"vat.tax-input-placeholder\"),\n        onChange: this.handleVatChange,\n        value: this.state.vat\n      }), __jsx(FormErrorMsg, {\n        show: this.state.errors[\"vat\"],\n        msg: this.state.errors[\"vat\"]\n      })), this.state.showComponent && this.state.documents.map((item, index) => {\n        return __jsx(\"label\", {\n          className: \"auth__form-label\"\n        }, __jsx(\"span\", {\n          className: \"auth__input-label\"\n        }, __jsx(Translate, {\n          id: \"document.upload\"\n        }), \" \", item.documentTitle), __jsx(UploadBox, {\n          className: \"createshop__centered-upload\",\n          handleSelectFile: this.handleSelectFile,\n          index: index,\n          oldFile: this.state.files\n        }), __jsx(\"div\", {\n          className: \"col-12 text-center mt-4\"\n        }, this.state.showUploadFileError && this.state.files[index] == null && __jsx(\"span\", {\n          className: \"country-error\"\n        }, __jsx(Translate, {\n          id: \"document.upload-file-error\"\n        }))));\n      }));\n    })), __jsx(\"div\", {\n      className: \"createshop__full-check-cnt d-flex align-items-start\"\n    }, __jsx(\"input\", {\n      type: \"checkbox\",\n      id: \"agreement\",\n      name: \"agreement\",\n      value: this.state.isAccepted,\n      onChange: this.changeAccept\n    }), __jsx(\"label\", {\n      for: \"agreement\",\n      className: \"createshop__check-text\"\n    }, __jsx(Translate, {\n      id: \"vat.vat-end-msg\"\n    })), __jsx(\"br\", null))), __jsx(\"div\", {\n      className: \"createshop__btm text-align-center-ltr mb-5\"\n    }, __jsx(\"div\", {\n      className: \"auth__btn\"\n    }, __jsx(\"button\", {\n      disabled: !this.state.isAccepted,\n      className: \"createshop__primary-btn primary-btn\"\n    }, this.state.showSubmitLoader ? __jsx(Loading, {\n      type: \"white\",\n      width: \"20px\",\n      height: \"100%\"\n    }) : __jsx(Translate, {\n      id: \"vat.submit\"\n    }))))));\n  }\n\n}\n\n_defineProperty(Vat, \"contextType\", CreateShopContext);\n\nexport default Vat;","map":null,"metadata":{},"sourceType":"module"}