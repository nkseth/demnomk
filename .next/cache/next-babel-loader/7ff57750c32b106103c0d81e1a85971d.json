{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { Translate } from \"react-localize-redux\";\nimport { client_categoryBrands } from \"../../../../../../lib/api/client/clientCommon\";\nimport { Loading } from \"../../../../../common\";\nimport SearchIcon from \"./../../../../../../assets/icons/search-gray.svg\"; // import \"./CheckBoxList.scss\";\n// import \"./CheckBoxList-rtl.scss\";\n\nvar SearchTimer = null;\nexport default (function (_ref) {\n  var catId = _ref.catId,\n      itemClass = _ref.itemClass,\n      listClass = _ref.listClass,\n      placeholder = _ref.placeholder,\n      _ref$pageSize = _ref.pageSize,\n      pageSize = _ref$pageSize === void 0 ? 10 : _ref$pageSize,\n      _ref$onSelect = _ref.onSelect,\n      onSelect = _ref$onSelect === void 0 ? function () {} : _ref$onSelect,\n      _ref$selecteIds = _ref.selecteIds,\n      selecteIds = _ref$selecteIds === void 0 ? [] : _ref$selecteIds;\n\n  var _useState = useState([]),\n      brands = _useState[0],\n      setBrands = _useState[1];\n\n  var _useState2 = useState(false),\n      brandsLoading = _useState2[0],\n      setBrandsLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      seeLoading = _useState3[0],\n      setSeeLoading = _useState3[1];\n\n  var query = React.useMemo(function () {\n    return {\n      pageSize: pageSize,\n      pageNumber: 1,\n      search: \"\",\n      catId: catId,\n      BrandIds: selecteIds\n    };\n  }, [catId]);\n  query.BrandIds = selecteIds;\n  var resCount = useRef(200);\n\n  var getBrands = function getBrands() {\n    setBrandsLoading(true);\n    client_categoryBrands(query).then(function (res) {\n      resCount.current = res.result.length;\n      setBrands(res.result);\n      setBrandsLoading(false);\n    })[\"catch\"](function (err) {\n      console.log(err);\n      setBrands([]);\n      setBrandsLoading(false);\n    });\n  };\n\n  useEffect(function () {\n    getBrands();\n  }, [catId]);\n\n  var handleSeeClick = function handleSeeClick(e) {\n    e.preventDefault();\n    if (seeLoading) return;\n    setSeeLoading(true);\n    query.pageNumber = query.pageNumber + 1;\n    client_categoryBrands(query).then(function (res) {\n      resCount.current = res.result.length;\n      setBrands([].concat(_toConsumableArray(brands), _toConsumableArray(res.result)));\n    })[\"catch\"](function (err) {\n      console.log(err);\n      setBrands([]);\n    })[\"finally\"](function () {\n      setSeeLoading(false);\n    });\n  };\n\n  var handleSearchChange = function handleSearchChange(e) {\n    var q = e.target.value;\n    query.search = q;\n    query.pageNumber = 1;\n\n    if (SearchTimer) {\n      clearTimeout(SearchTimer);\n      SearchTimer = null;\n    }\n\n    var callback = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(query) {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                setBrandsLoading(true);\n                _context.prev = 1;\n                _context.next = 4;\n                return client_categoryBrands(query);\n\n              case 4:\n                res = _context.sent;\n\n                if (res.result) {\n                  resCount.current = res.result.length;\n                  setBrands(res.result);\n                }\n\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](1);\n                setBrands([]);\n\n              case 11:\n                _context.prev = 11;\n                setBrandsLoading(false);\n                return _context.finish(11);\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[1, 8, 11, 14]]);\n      }));\n\n      return function callback(_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    SearchTimer = setTimeout(callback.bind(null, query), 500);\n  };\n\n  var handleCheckChange = function handleCheckChange(e) {\n    onSelect({\n      value: e.target.name,\n      id: e.target.value\n    }, e.target.checked);\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"checklist__search\"\n  }, __jsx(SearchIcon, {\n    className: \"checklist__search-input-icon\"\n  }), __jsx(\"input\", {\n    onChange: handleSearchChange,\n    type: \"text\" // value={searchText}\n    ,\n    className: \"checklist__search-input\",\n    placeholder: placeholder\n  })), __jsx(\"ul\", {\n    className: \"checklist \".concat(listClass)\n  }, brandsLoading ? __jsx(Loading, {\n    width: \"20px\",\n    height: \"20px\"\n  }) : brands.map(function (brand, index) {\n    return __jsx(\"label\", {\n      key: index,\n      className: \"checklist__label\"\n    }, __jsx(\"li\", {\n      className: \"\".concat(itemClass, \" d-flex justify-content-between align-items-center\")\n    }, __jsx(\"div\", null, __jsx(\"input\", {\n      className: \"checklist__check\",\n      type: \"checkbox\",\n      name: brand.brandTitle,\n      value: brand.brandId,\n      checked: selecteIds.includes(brand.brandId) ? true : false,\n      onChange: handleCheckChange\n    }), __jsx(\"span\", null, brand.brandTitle)), __jsx(\"span\", null, \"(\", brand.goodsCount, \")\")));\n  })), resCount.current >= pageSize && !brandsLoading && __jsx(React.Fragment, null, seeLoading ? __jsx(Loading, {\n    width: \"20px\",\n    height: \"20px\"\n  }) : __jsx(\"a\", {\n    href: \"\",\n    onClick: handleSeeClick,\n    className: \"seemore__link\"\n  }, __jsx(Translate, {\n    id: \"seemore\"\n  }))));\n});","map":null,"metadata":{},"sourceType":"module"}